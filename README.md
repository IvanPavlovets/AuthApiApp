# AuthApiApp

# ТЗ
Используя SpringBoot создать api аутентификации:<br>

Метод принимает пароль и юзернейм и добавляет их в сессионный кэш одной строкой (желательно в безопасном виде)<br>

Метод принимает пароль или хэш пароля и проверяет есть ли в кэше данный юзер и возвращает да/нет <br>

Написать юнит тесты на оба метода<br>

В ридми добавить тестовые данные для проверки апи через постман и пара слов о выбранном решение<br>
Прислать  ссылку на гит, где лежит выполненное задание)<br>

# Описание 
По ТЗ указанно "создать api" это скорее всего иметься ввиду создать REST api <br>
(речь идет НЕ про обычный @Controller, который взаимодействует с MVC представлением/html страницами), <br>
а поскольку в Rest состояние не сохраняется на сервере (stateless), <br>
то надо сделать аутентификацию с помощью токенов JWT, JWT хранится на клиенте. <br>
Вариант с JWT + храние пользователей в памяти ConcurrentHashMap<String, Person>. <br>
Последовательность действий для проверки логики через POSTMAN: <br>
Тестовые данные для проверки -JSON с полями username = “Ivan”, password = “12345”: <br>

{
"username": "Ivan",
"password": "12345"
}
1)  стучимся по URL регистрации http://localhost:8080/sign-up <br>
 В POSTMAN выбираем тип запроса POST. Указываем URL (http://localhost:8080/ sign-up). <br>
 Переходим на вкладку “raw” и указываем JSON с полями username = “Ivan”, password = “12345” (см. картинку). Жмем “Send” <br>
 в ответ получаем статус 200, запрос выполнился успешно. <br>

![](01_images/sign-up.png) <br>
Рисунок 1. запрос на регистрацию и ответ со статусом 200 (выполнен удачно) <br>

2) стучимся по URL что бы получить JWT токен http://localhost:8080/login <br>
 В POSTMAN выбираем тип запроса POST. Указываем URL (http://localhost:8080/login). <br>
 Переходим на вкладку “raw” и указываем JSON с полями (см. картинку). Жмем “Send” <br>
 в ответ получаем статус 200. Переходим во вкладку Headers и там ищем и копируем наш токен в строке Authorization, после Bearer <br>

![](01_images/login.png) <br>
Рисунок 2. запрос на авторизацию пользователя, получения токена <br>

3) стучимся по URL в метод check, предварительно получив токен в предыдущем действии, <br>
 что бы проверить присутствие юзера в хранилище (ConcurrentHashMap) http://localhost:8080/check?password=12345 <br>
 В POSTMAN выбираем тип запроса POST. Указываем URL (http://localhost:8080/check?password=12345). <br>
 Во вкладке “Params” указываем передаваемый параметр, не в теле запроса (как в POST), <br>
 а в виде параметра строки запроса/заголовок: password = “12345”. <br>
 в ответ получаем статсус 200 и boolean значение “true”. Это свидетельствует о правильности работы нашей логик, <br>
 в хранилище присутсвует пользователь с данным паролем <br>

![](01_images/check.png) <br>
Рисунок 3. запрос на присутсвие пользователя с данным паролем, необходим токен для выполенния или отвтет со стасум 403 <br>

Логика работы метода: Проверяет, существует ли пользователь с указанным паролем. <br>
* BCrypt — это алгоритм одностороннего хеширования, уникальный <br>
* хеш невозможно преобразовать для получения исходного пароля. <br>
* С помощью BCrypt.matches() можно сравнить необработанный <br>
* пароль (введенный пользователем) с сохраненным хешем. <br>
* @param rawPassword пароль в открытом виде (не хэшированный) <br>
* @return true если найден пользователь с совпадающим паролем <br>